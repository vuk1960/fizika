<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <title>Fizika mester - 7.A Mozg√°sok oktat√≥csomag</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; max-width: 950px; margin: 20px auto; padding: 20px; background: #eceff1; }
        .card { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.15); }
        .mode-selector { display: flex; justify-content: center; gap: 20px; margin-bottom: 25px; background: #cfd8dc; padding: 15px; border-radius: 10px; }
        .mode-btn { padding: 12px 30px; border: none; cursor: pointer; border-radius: 8px; font-weight: bold; transition: 0.3s; }
        .mode-btn.active { background: #1a237e; color: white; transform: scale(1.05); }
        
        .nav-menu { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 20px; }
        .nav-btn { background: #e0e0e0; border: none; padding: 12px; cursor: pointer; border-radius: 6px; font-weight: bold; }
        .nav-btn.active { background: #2196f3; color: white; }
        .nav-btn.completed { background: #4caf50 !important; color: white; }

        .theory-box { background: #e3f2fd; padding: 15px; border-left: 6px solid #2196f3; border-radius: 6px; margin-bottom: 20px; display: none; line-height: 1.5; }
        .theory-btn { background: #ff9800; color: white; border: none; padding: 10px 20px; cursor: pointer; border-radius: 6px; font-weight: bold; margin-bottom: 10px; }

        .exercise-area { border: 2px solid #e1e4e8; padding: 25px; border-radius: 10px; background: #fafafa; min-height: 250px; }
        input { padding: 10px; width: 140px; border: 2px solid #ccc; border-radius: 6px; font-size: 1.1em; }
        .action-btn { background: #4caf50; color: white; border: none; padding: 12px 25px; cursor: pointer; border-radius: 6px; font-weight: bold; margin: 5px; }
        .solution { display: none; background: #fffde7; padding: 15px; border-radius: 8px; border: 1px solid #fbc02d; margin-top: 15px; line-height: 1.6; }
        .timer { font-size: 1.5em; font-weight: bold; text-align: right; color: #d32f2f; margin-bottom: 5px; }
        .grade-box { display: none; text-align: center; padding: 30px; border: 5px solid #1a237e; border-radius: 15px; background: #e8eaf6; margin-top: 20px; }
    </style>
</head>
<body>

<div class="card">
    <div id="exam-timer" class="timer" style="display:none;">00:00</div>
    <h1 style="text-align:center; color: #1a237e;">Fizika interakt√≠v oktat√≥</h1>
    <h1 style="text-align:center; color: #1a237e;">Tan√°ri seg√©danyag VUK-t√≥l</h1>
    
    <div class="mode-selector">
        <button id="mode-gyak" class="mode-btn active" onclick="setMode('gyak')">Gyakorl√°s</button>
        <button id="mode-felel" class="mode-btn" onclick="setMode('felel')">Felel√©s (Jegyre)</button>
    </div>

    <div class="nav-menu">
        <button class="nav-btn active" id="btn-uni" onclick="switchCat('uni')">Egyenletes</button>
        <button class="nav-btn" id="btn-acc" onclick="switchCat('acc')">Gyorsul√≥</button>
        <button class="nav-btn" id="btn-meet" onclick="switchCat('meet')">Tal√°lkoz√°s</button>
        <button class="nav-btn" id="btn-free" onclick="switchCat('free')">Szabades√©s/Haj√≠t√°s</button>
    </div>

    <!-- Elm√©leti r√©sz -->
    <button class="theory-btn" onclick="toggleTheory()">üìñ Elm√©leti √∂sszefoglal√≥</button>
    <div id="theory-text" class="theory-box"></div>

    <div class="exercise-area">
        <div id="exercise-text" style="font-size: 1.25em; margin-bottom: 20px; line-height: 1.4;"></div>
        <div id="inputs-container"></div>
        <div id="controls">
            <button class="action-btn" id="check-btn" onclick="checkAnswers()">Ellen≈ërz√©s</button>
            <button class="action-btn" style="background:#673ab7" onclick="generateTask()">√öj feladat</button>
            <button class="action-btn" style="background:#0288d1" id="sol-btn" onclick="showSolution()">Megold√°s levezet√©se</button>
        </div>
        <div id="feedback" style="margin-top: 15px; font-weight: bold;"></div>
        <div id="solution-box" class="solution"></div>
    </div>
    <div id="grade-display" class="grade-box"></div>
</div>

<script>
    let appMode = 'gyak', currentCat = 'uni', currentTasks = [], fullSteps = "", solSeen = false;
    let examScore = { uni: 0, acc: 0, meet: 0, free: 0 }, examDone = { uni: false, acc: false, meet: false, free: false };
    let seconds = 0, timerInterval;

    const theoryData = {
        uni: "<b>Egyenes vonal√∫ egyenletes mozg√°s:</b><br>K√©plet: <i>s = v ¬∑ t</i>. A sebess√©g √°lland√≥.<br>√Åtv√°lt√°sok: 1 m/s = 3,6 km/h; 1 perc = 60 s.",
        acc: "<b>Egyenletesen v√°ltoz√≥ mozg√°s:</b><br>Sebess√©g: <i>v = a ¬∑ t</i><br>√öt: <i>s = (a/2) ¬∑ t¬≤</i><br>√Åtlagsebess√©g (v‚ÇÄ=0 eset√©n): <i>v_√°tl = s / t</i> vagy <i>v/2</i>.",
        meet: "<b>Tal√°lkoz√°s √©s √ºld√∂z√©s:</b><br>Szembe halad√°s: <i>v_rel = v‚ÇÅ + v‚ÇÇ</i><br>√úld√∂z√©s: <i>v_rel = v‚ÇÅ - v‚ÇÇ</i> (v‚ÇÅ a gyorsabb)<br>Id≈ë: <i>t = s_t√°vols√°g / v_rel</i>",
        free: "<b>Szabades√©s √©s Haj√≠t√°s (g = 10 m/s¬≤):</b><br>Leejt√©s: <i>v = g ¬∑ t</i>; <i>h = 5 ¬∑ t¬≤</i><br>F√ºgg≈ëleges felfel√© haj√≠t√°s: <i>v = v‚ÇÄ - g ¬∑ t</i>. A cs√∫csponton v = 0, innen <i>v‚ÇÄ = g ¬∑ t</i> √©s <i>h_max = v‚ÇÄ¬≤ / 2g</i>."
    };

    function toggleTheory() {
        const box = document.getElementById('theory-text');
        box.innerHTML = theoryData[currentCat];
        box.style.display = (box.style.display === 'block') ? 'none' : 'block';
    }

    function setMode(m) {
        appMode = m;
        document.getElementById('mode-gyak').className = 'mode-btn' + (m === 'gyak' ? ' active' : '');
        document.getElementById('mode-felel').className = 'mode-btn' + (m === 'felel' ? ' active' : '');
        resetExam();
        if(m === 'felel') startTimer(); else stopTimer();
        generateTask();
    }

    function startTimer() { seconds = 0; document.getElementById('exam-timer').style.display = 'block'; clearInterval(timerInterval); timerInterval = setInterval(() => { seconds++; let m = Math.floor(seconds/60).toString().padStart(2,'0'), s = (seconds%60).toString().padStart(2,'0'); document.getElementById('exam-timer').innerText = `${m}:${s}`; }, 1000); }
    function stopTimer() { clearInterval(timerInterval); document.getElementById('exam-timer').style.display = 'none'; }
    function resetExam() { examScore = { uni: 0, acc: 0, meet: 0, free: 0 }; examDone = { uni: false, acc: false, meet: false, free: false }; document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('completed')); document.getElementById('grade-display').style.display = 'none'; }
    function switchCat(cat) { currentCat = cat; document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active')); document.getElementById('btn-' + cat).classList.add('active'); if(document.getElementById('theory-text').style.display === 'block') toggleTheory(); generateTask(); }

    function generateTask() {
        document.getElementById('feedback').innerHTML = '';
        document.getElementById('solution-box').style.display = 'none';
        document.getElementById('check-btn').disabled = false;
        solSeen = false;
        const r = Math.random();
        if(currentCat === 'uni') genUni(r);
        else if(currentCat === 'acc') genAcc(r);
        else if(currentCat === 'meet') genMeet(r);
        else if(currentCat === 'free') genFree(r);
        renderInputs();
    }

    function renderInputs() { document.getElementById('inputs-container').innerHTML = currentTasks.map((t, i) => `<div style="margin:10px 0;">${t.label}: <input type="number" id="ans-${i}"> <b>${t.unit}</b></div>`).join(''); }

    // --- GENER√ÅTOROK ---
    function genUni(r) {
        let v = 5 + Math.floor(Math.random()*20), t = 10 + Math.floor(Math.random()*50), s = v*t;
        if(r < 0.33) {
            document.getElementById('exercise-text').innerHTML = `Egy test <b>${v} m/s</b> sebess√©ggel halad. Mennyi id≈ë alatt tesz meg <b>${s} m</b>-t?`;
            currentTasks = [{label:"Id≈ë", a:t, unit:"s"}]; fullSteps = `t = s / v = ${s} / ${v} = ${t} s.`;
        } else if(r < 0.66) {
            document.getElementById('exercise-text').innerHTML = `Egy aut√≥ <b>${t} s</b> alatt <b>${s} m</b> utat tesz meg. Mekkora a sebess√©ge?`;
            currentTasks = [{label:"Sebess√©g", a:v, unit:"m/s"}]; fullSteps = `v = s / t = ${s} / ${t} = ${v} m/s.`;
        } else {
            document.getElementById('exercise-text').innerHTML = `Egy j√°rm≈± <b>${v*3.6} km/h</b> sebess√©ggel halad <b>${t} s</b>-ig. Mekkora utat tesz meg?`;
            currentTasks = [{label:"√öt", a:s, unit:"m"}]; fullSteps = `v = ${v*3.6} / 3.6 = ${v} m/s. <br> s = v * t = ${v} * ${t} = ${s} m.`;
        }
    }

    function genAcc(r) {
        let a = 2 + Math.floor(Math.random()*3), t = 4 + Math.floor(Math.random()*6), v = a*t, s = 0.5*a*t*t;
        if(r < 0.33) {
            document.getElementById('exercise-text').innerHTML = `Nyugalomb√≥l indul√≥ test <b>${t} s</b> alatt <b>${v} m/s</b>-ra gyorsul. Gyorsul√°s √©s √∫t?`;
            currentTasks = [{label:"Gyorsul√°s", a:a, unit:"m/s¬≤"}, {label:"√öt", a:s, unit:"m"}];
            fullSteps = `a = v/t = ${v}/${t} = ${a} m/s¬≤. <br> s = a/2 * t¬≤ = ${a/2} * ${t*t} = ${s} m.`;
        } else if(r < 0.66) {
            document.getElementById('exercise-text').innerHTML = `<b>${a} m/s¬≤</b> gyorsul√°ssal indul√≥ g√©pkocsi <b>${s} m</b> utat tesz meg. Id≈ë √©s √°tlagsebess√©g?`;
            currentTasks = [{label:"Id≈ë", a:t, unit:"s"}, {label:"√Åtlagsebess√©g", a:s/t, unit:"m/s"}];
            fullSteps = `t = ‚àö(2s/a) = ‚àö(${2*s}/${a}) = ${t} s. <br> v_√°tl = s/t = ${s/t} m/s.`;
        } else {
            document.getElementById('exercise-text').innerHTML = `Mekkora utat tesz meg a test <b>${t} s</b> alatt, ha <b>${a} m/s¬≤</b> gyorsul√°ssal indul?`;
            currentTasks = [{label:"√öt", a:s, unit:"m"}]; fullSteps = `s = a/2 * t¬≤ = ${a/2} * ${t*t} = ${s} m.`;
        }
    }

    function genMeet(r) {
        let v1 = 20, v2 = 10, d = 300, t = 10;
        if(r < 0.5) {
            let dist = (v1+v2)*t;
            document.getElementById('exercise-text').innerHTML = `K√©t test <b>${dist} m</b> t√°vols√°gb√≥l szembe indul <b>${v1} m/s</b> √©s <b>${v2} m/s</b> sebess√©ggel. Mikor tal√°lkoznak?`;
            currentTasks = [{label:"Tal√°lkoz√°s ideje", a:t, unit:"s"}]; fullSteps = `v_rel = v1+v2 = 30 m/s. <br> t = s/v_rel = ${dist}/30 = ${t} s.`;
        } else {
            let delay = 5, s_el = v2*delay, v_rel = v1-v2, t_u = s_el/v_rel;
            document.getElementById('exercise-text').innerHTML = `Egy <b>${v2} m/s</b>-os test ut√°n <b>${delay} s</b> m√∫lva indul egy <b>${v1} m/s</b>-os √ºld√∂z≈ë.`;
            currentTasks = [{label:"Utol√©r√©si id≈ë", a:t_u, unit:"s"}]; fullSteps = `El≈ëny = ${v2}*${delay}=${s_el} m. <br> v_rel = ${v1}-${v2}=${v_rel} m/s. <br> t = ${s_el}/${v_rel} = ${t_u} s.`;
        }
    }

    function genFree(r) {
        let g = 10;
        if(r < 0.33) { // Szabades√©s
            let t = 3 + Math.floor(Math.random()*3), h = 0.5*g*t*t;
            document.getElementById('exercise-text').innerHTML = `Szabadon es≈ë test <b>${t} s</b> alatt √©r f√∂ldet. Magass√°g √©s becsap√≥d√°si sebess√©g?`;
            currentTasks = [{label:"Magass√°g", a:h, unit:"m"}, {label:"Sebess√©g", a:g*t, unit:"m/s"}];
            fullSteps = `h = g/2 * t¬≤ = 5 * ${t*t} = ${h} m. <br> v = g * t = 10 * ${t} = ${g*t} m/s.`;
        } else if(r < 0.66) { // Felfel√© haj√≠t√°s
            let v0 = 20 + Math.floor(Math.random()*20), t_f = v0/g, h_m = (v0*v0)/(2*g);
            document.getElementById('exercise-text').innerHTML = `F√ºgg≈ëlegesen felfel√© dobunk egy testet <b>${v0} m/s</b> kezd≈ësebess√©ggel.`;
            currentTasks = [{label:"Emelked√©si id≈ë", a:t_f, unit:"s"}, {label:"Max magass√°g", a:h_m, unit:"m"}];
            fullSteps = `t = v‚ÇÄ/g = ${v0}/10 = ${t_f} s. <br> h_max = v‚ÇÄ¬≤/2g = ${v0*v0}/20 = ${h_m} m.`;
        } else { // Magass√°gb√≥l dob√°s (id≈ëb≈ël v0)
            let t = 3, v0 = 30, h = 45;
            document.getElementById('exercise-text').innerHTML = `Egy felfel√© dobott test <b>${t} s</b> alatt √©rt fel a p√°ly√°ja cs√∫cs√°ra. Kezd≈ësebess√©g √©s magass√°g?`;
            currentTasks = [{label:"Kezd≈ësebess√©g", a:v0, unit:"m/s"}, {label:"Max magass√°g", a:h, unit:"m"}];
            fullSteps = `A cs√∫cson v=0, √≠gy v‚ÇÄ = g * t = 10 * ${t} = ${v0} m/s. <br> h = v‚ÇÄ¬≤/2g = 900/20 = ${h} m.`;
        }
    }

    function showSolution() {
        solSeen = true;
        if(appMode === 'felel') { document.getElementById('feedback').innerHTML = "<span style='color:red'>Megold√°st k√©rt√©l! K√©rj √öJ feladatot a pont√©rt!</span>"; document.getElementById('check-btn').disabled = true; }
        document.getElementById('solution-box').innerHTML = `<b>Levezet√©s:</b><br>${fullSteps}`;
        document.getElementById('solution-box').style.display = 'block';
    }

    function checkAnswers() {
        let allC = true, anyE = false;
        currentTasks.forEach((t, i) => { let v = document.getElementById(`ans-${i}`).value; if(v==="") anyE = true; if(Math.abs(parseFloat(v)-t.a)>0.5) allC = false; });
        const f = document.getElementById('feedback');
        if(anyE) { f.innerHTML = "T√∂ltsd ki az √∂sszes mez≈ët!"; return; }
        if(allC) { 
            f.innerHTML = "<span style='color:green'>‚úÖ Kiv√°l√≥, helyes megold√°s!</span>"; 
            if(appMode==='felel' && !solSeen) { 
                examScore[currentCat]=1; examDone[currentCat]=true; 
                document.getElementById('btn-'+currentCat).classList.add('completed'); 
                checkExamEnd(); 
            } 
        } else f.innerHTML = "<span style='color:red'>‚ùå Hib√°s sz√°m√≠t√°s, pr√≥b√°ld √∫jra!</span>";
    }

    function checkExamEnd() {
        if(Object.values(examDone).filter(v=>v).length === 4) {
            stopTimer(); let score = Object.values(examScore).reduce((a,b)=>a+b,0); let grade = score+1; if(score===0) grade=1;
            const d = document.getElementById('grade-display'); d.innerHTML = `<h2>VIZSGA BIZONY√çTV√ÅNY</h2>N√©v: <input type="text" id="sname" placeholder="√çrd be a neved"><br>Id≈ë: ${document.getElementById('exam-timer').innerText}<br><h1>EREDM√âNY: ${grade}</h1><button class="action-btn" onclick="saveResult(${grade})">Bizony√≠tv√°ny ment√©se</button>`; d.style.display = 'block';
        }
    }

    function saveResult(g) {
        let n = document.getElementById('sname').value || "N√©vtelen", t = document.getElementById('exam-timer').innerText;
        let blob = new Blob([`FIZIKA VIZSGA\nN√©v: ${n}\nId≈ë: ${t}\nJegy: ${g}\nD√°tum: ${new Date().toLocaleString()}`], {type:"text/plain"});
        let a = document.createElement("a"); a.download=`fizika_jegy_${n}.txt`; a.href=URL.createObjectURL(blob); a.click();
    }

    generateTask();
</script>
</body>

</html>
